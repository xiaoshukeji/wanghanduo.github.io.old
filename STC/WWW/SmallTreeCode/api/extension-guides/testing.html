<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from code.visualstudio.com/api/extension-guides/testing by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 04 Jan 2023 11:25:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="hNs7DXrTySP_X-0P_AC0WulAXvUwgSXEmgfcO2r79dw" />

  <!-- Twitter and Facebook OpenGraph Metadata-->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@code" />

  <meta name="keywords" content="vscode API" />

<meta name="description" content="Testing APIs in VS Code allow users to discover and run unit tests in their workspace" />

<meta name="ms.prod" content="vs-code" />
<meta name="ms.TOCTitle" content="Testing API" />
<meta name="ms.ContentId" content="4ced0b2a-3f5a-44e6-a8b0-66b9012af8c0" />
<meta name="ms.topic" content="conceptual" />
<meta name="ms.date" content="12/7/2022" />
<!-- Twitter and Facebook OpenGraph Metadata-->
<meta name="twitter:card" content="summary_large_image" />
<meta property="og:url" content="testing.html" />

<meta property="og:description" content="Testing APIs in VS Code allow users to discover and run unit tests in their workspace" />

<meta property="og:type" content="article" />
<meta property="og:title" content="Testing API" />
<meta property="og:image" content="../../opengraphimg/opengraph-docs.png" />


  <link rel="shortcut icon" href="../../favicon.ico" sizes="128x128" />
  <link rel="apple-touch-icon" href="../../apple-touch-icon.png">

  <title>Testing API | Visual Studio Code Extension
API</title>

  <link rel="stylesheet" href="../../vendor/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="../../dist/style.css">

  <script type="text/javascript" src="../../../js.monitor.azure.com/scripts/c/ms.analytics-web-3.min.js"></script>
  <script>
  window.appInsights = new oneDS.ApplicationInsights();
  window.appInsights.initialize({
    instrumentationKey: "1a3eb3104447440391ad5f2a6ee06a0a-62879566-bc58-4741-9650-302bf2af703f-7103",
    webAnalyticsConfiguration:{ // Web Analytics Plugin configuration
        urlCollectQuery:true, 
        autoCapture: {
          scroll: true,
          pageView: true,
          onLoad: true,
          onUnload: true,
          click: true,
          resize: true,
          jsError: true
        }
    }
  }, []);
  </script>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../www.google-analytics.com/analytics.js','ga');
  </script>  
  <link rel="alternate" type="application/atom+xml" title="RSS Feed for code.visualstudio.com" href="../../feed.xml" />
</head>

<body>
  <!-- EU Cookie Compliance JS -->
  <script src="../../../wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>

  <div id="main">
          <div class="navbar-fixed-container">
              <div class="navbar navbar-inverse navbar-fixed-top ">
                  <div id='cookie-banner'></div>        <nav role="navigation" aria-label="Top Level">
                      <div class="container">
                          <div class="nav navbar-header">
                              <a role="button" id="skip-to-content" class="link-button" href="#main-content">Skip to content<i>&nbsp;</i><span class="glyphicon glyphicon-menu-down"></span></a>
                              <a class="navbar-brand" id="navbar-brand" href="../../index.html">Visual Studio Code</a>
                              <button type="button" class="navbar-toggle" role="navigation" data-toggle="collapse" data-target=".navbar-collapse" aria-label="Toggle Navigation Menu">
                                  <span class="icon-bar"></span>
                                  <span class="icon-bar"></span>
                                  <span class="icon-bar"></span>
                              </button>
                          </div>
                          <div class="navbar-collapse collapse" role="navigation">
                              <ul class="nav navbar-nav navbar-left">
                                  <li ><a id="nav-docs" href="../../docs.html">Docs</a></li>
                                  <li ><a id="nav-updates" href="../../updates/v1_74.html">Updates</a></li>
                                  <li ><a id="nav-blogs" href="../../blogs.html">Blog</a></li>
                                  <li class="active" ><a id="nav-extend" href="../../api.html">API</a></li>
                                  <li><a href="https://marketplace.visualstudio.com/VSCode" target="_blank" id="nav-extensions">Extensions</a></li>
                                  <li ><a id="nav-faqs" href="../../docs/supporting/faq.html">FAQ</a></li>
                                  <li ><a id="nav-learn" href="../../learn.html">Learn</a></li>
                                  <li class='search visible-xs visible-sm'
                                      ><a href="../../Search.html">Search</a></li>
                              </ul>
          
                              <ul class="nav navbar-nav navbar-right" role="presentation">
                                  <!-- Floating search icon -->
                                  <li>
                                      <a href="../../Search.html" title="Search" class="btn search-btn" id="nav-search">
                                          <img class="search-icon" src="../../assets/icons/search.svg" width="16px" height="16px" alt="Search"/>
                                          <img class="search-icon-inverted" src="../../assets/icons/search_dark.svg" width="16px" height="16px" alt="Search" />
                                      </a>
                                  </li>
                                  <!-- Actual search icon -->
                                  <li class="search" role="presentation">
                                      <form class="nav-search search-form" role="search" aria-label="Search">
                                          <div class="input-group" role="presentation">
                                              <input type="text" name="q" class="search-box form-control" placeholder="Search Docs" aria-label="Search text"/>
                                              <span class="input-group-btn">
                                                  <button tabindex="0" class="btn" type="submit" aria-label="Search">
                                                          <img class="search-icon" src="../../assets/icons/search.svg" width="16px" height="16px" alt="Search" />
                                                          <img class="search-icon-inverted" src="../../assets/icons/search_dark.svg" width="16px" height="16px" alt="Search" />
                                                  </button>
                                              </span>
                                          </div>
                                      </form>                        </li>
                                  <!-- this was hiden in the home and download page, keeping it for now -->
                                  <li><a class="link-button" href="../../Download.html" id="nav-download">
                                      <img class="download-icon" src="../../assets/icons/download.svg" width="16px" height="16px" alt="Download VS Code"/>
                                      <img class="download-icon-inverted" src="../../assets/icons/download-black.svg" width="16px" height="16px" alt="Download VS Code" />
                                      <span>Download</span>
                                  </a></li>
                              </ul>
                          </div>
                      </div>
                  </nav>
              </div>
          </div>          <div class="updates-banner  ">
              <div class="container">
                  <p class="message"><a href="../../updates/v1_74.html" id="banner-link-updates">Version 1.74</a> is now available! Read about the new features and fixes from November.</p> 
              </div>
              <div tabindex="0" role="button" title="Dismiss this update" class="dismiss-btn" id="banner-dismiss-btn"><span class="sr-only">Dismiss this update</span><span aria-hidden="true" class="glyph-icon"></span></div>
          </div>      <div role="main" id="main-content">
        <div class="container body-content docs">
	<div class="row">
		<div class="col-md-2 docs-navbar-container">
			<nav id="docs-navbar" class="docs-nav visible-md visible-lg">
			  <ul class="nav" id="main-nav">
			  <li >
			    <a class="docs-home" href="../../api.html" >Overview</a>
			  </li>
			  
			<li class="panel collapsed">
			  <a class="area" role="button" href="#get-started-articles" data-parent="#main-nav" data-toggle="collapse">Get Started</a>
			  <ul id="get-started-articles" class="collapse ">
			
			    <li >
			      <a href="../get-started/your-first-extension.html" >Your First Extension</a>
			    </li>
			      
			    <li >
			      <a href="../get-started/extension-anatomy.html" >Extension Anatomy</a>
			    </li>
			      
			    <li >
			      <a href="../get-started/wrapping-up.html" >Wrapping Up</a>
			    </li>
			      
			  </ul>
			</li>
			    
			<li class="panel collapsed">
			  <a class="area" role="button" href="#extension-capabilities-articles" data-parent="#main-nav" data-toggle="collapse">Extension Capabilities</a>
			  <ul id="extension-capabilities-articles" class="collapse ">
			
			    <li >
			      <a href="../extension-capabilities/overview.html" >Overview</a>
			    </li>
			      
			    <li >
			      <a href="../extension-capabilities/common-capabilities.html" >Common Capabilities</a>
			    </li>
			      
			    <li >
			      <a href="../extension-capabilities/theming.html" >Theming</a>
			    </li>
			      
			    <li >
			      <a href="../extension-capabilities/extending-workbench.html" >Extending Workbench</a>
			    </li>
			      
			  </ul>
			</li>
			    
			<li class="panel active expanded">
			  <a class="area" role="button" href="#extension-guides-articles" data-parent="#main-nav" data-toggle="collapse">Extension Guides</a>
			  <ul id="extension-guides-articles" class="collapse in">
			
			    <li >
			      <a href="overview.html" >Overview</a>
			    </li>
			      
			    <li >
			      <a href="command.html" >Command</a>
			    </li>
			      
			    <li >
			      <a href="color-theme.html" >Color Theme</a>
			    </li>
			      
			    <li >
			      <a href="file-icon-theme.html" >File Icon Theme</a>
			    </li>
			      
			    <li >
			      <a href="product-icon-theme.html" >Product Icon Theme</a>
			    </li>
			      
			    <li >
			      <a href="tree-view.html" >Tree View</a>
			    </li>
			      
			    <li >
			      <a href="webview.html" >Webview</a>
			    </li>
			      
			    <li >
			      <a href="notebook.html" >Notebook</a>
			    </li>
			      
			    <li >
			      <a href="custom-editors.html" >Custom Editors</a>
			    </li>
			      
			    <li >
			      <a href="virtual-documents.html" >Virtual Documents</a>
			    </li>
			      
			    <li >
			      <a href="virtual-workspaces.html" >Virtual Workspaces</a>
			    </li>
			      
			    <li >
			      <a href="web-extensions.html" >Web Extensions</a>
			    </li>
			      
			    <li >
			      <a href="workspace-trust.html" >Workspace Trust</a>
			    </li>
			      
			    <li >
			      <a href="task-provider.html" >Task Provider</a>
			    </li>
			      
			    <li >
			      <a href="scm-provider.html" >Source Control</a>
			    </li>
			      
			    <li >
			      <a href="debugger-extension.html" >Debugger Extension</a>
			    </li>
			      
			    <li >
			      <a href="markdown-extension.html" >Markdown Extension</a>
			    </li>
			      
			    <li class="active">
			      <a href="testing.html" aria-label="Current Page: Test Extension">Test Extension</a>
			    </li>
			      
			    <li >
			      <a href="custom-data-extension.html" >Custom Data Extension</a>
			    </li>
			      
			    <li >
			      <a href="telemetry.html" >Telemetry</a>
			    </li>
			      
			  </ul>
			</li>
			    
			<li class="panel collapsed">
			  <a class="area" role="button" href="#ux-guidelines-articles" data-parent="#main-nav" data-toggle="collapse">UX Guidelines</a>
			  <ul id="ux-guidelines-articles" class="collapse ">
			
			    <li >
			      <a href="../ux-guidelines/overview.html" >Overview</a>
			    </li>
			      
			    <li >
			      <a href="../ux-guidelines/activity-bar.html" >Activity Bar</a>
			    </li>
			      
			    <li >
			      <a href="../ux-guidelines/sidebars.html" >Sidebars</a>
			    </li>
			      
			    <li >
			      <a href="../ux-guidelines/panel.html" >Panel</a>
			    </li>
			      
			    <li >
			      <a href="../ux-guidelines/status-bar.html" >Status Bar</a>
			    </li>
			      
			    <li >
			      <a href="../ux-guidelines/views.html" >Views</a>
			    </li>
			      
			    <li >
			      <a href="../ux-guidelines/editor-actions.html" >Editor Actions</a>
			    </li>
			      
			    <li >
			      <a href="../ux-guidelines/quick-picks.html" >Quick Picks</a>
			    </li>
			      
			    <li >
			      <a href="../ux-guidelines/command-palette.html" >Command Palette</a>
			    </li>
			      
			    <li >
			      <a href="../ux-guidelines/notifications.html" >Notifications</a>
			    </li>
			      
			    <li >
			      <a href="../ux-guidelines/webviews.html" >Webviews</a>
			    </li>
			      
			    <li >
			      <a href="../ux-guidelines/context-menus.html" >Context Menus</a>
			    </li>
			      
			    <li >
			      <a href="../ux-guidelines/walkthroughs.html" >Walkthroughs</a>
			    </li>
			      
			    <li >
			      <a href="../ux-guidelines/settings.html" >Settings</a>
			    </li>
			      
			  </ul>
			</li>
			    
			<li class="panel collapsed">
			  <a class="area" role="button" href="#language-extensions-articles" data-parent="#main-nav" data-toggle="collapse">Language Extensions</a>
			  <ul id="language-extensions-articles" class="collapse ">
			
			    <li >
			      <a href="../language-extensions/overview.html" >Overview</a>
			    </li>
			      
			    <li >
			      <a href="../language-extensions/syntax-highlight-guide.html" >Syntax Highlight Guide</a>
			    </li>
			      
			    <li >
			      <a href="../language-extensions/semantic-highlight-guide.html" >Semantic Highlight Guide</a>
			    </li>
			      
			    <li >
			      <a href="../language-extensions/snippet-guide.html" >Snippet Guide</a>
			    </li>
			      
			    <li >
			      <a href="../language-extensions/language-configuration-guide.html" >Language Configuration Guide</a>
			    </li>
			      
			    <li >
			      <a href="../language-extensions/programmatic-language-features.html" >Programmatic Language Features</a>
			    </li>
			      
			    <li >
			      <a href="../language-extensions/language-server-extension-guide.html" >Language Server Extension Guide</a>
			    </li>
			      
			    <li >
			      <a href="../language-extensions/embedded-languages.html" >Embedded Languages</a>
			    </li>
			      
			  </ul>
			</li>
			    
			<li class="panel collapsed">
			  <a class="area" role="button" href="#working-with-extensions-articles" data-parent="#main-nav" data-toggle="collapse">Testing and Publishing</a>
			  <ul id="working-with-extensions-articles" class="collapse ">
			
			    <li >
			      <a href="../working-with-extensions/testing-extension.html" >Testing Extensions</a>
			    </li>
			      
			    <li >
			      <a href="../working-with-extensions/publishing-extension.html" >Publishing Extensions</a>
			    </li>
			      
			    <li >
			      <a href="../working-with-extensions/bundling-extension.html" >Bundling Extensions</a>
			    </li>
			      
			    <li >
			      <a href="../working-with-extensions/continuous-integration.html" >Continuous Integration</a>
			    </li>
			      
			  </ul>
			</li>
			    
			<li class="panel collapsed">
			  <a class="area" role="button" href="#advanced-topics-articles" data-parent="#main-nav" data-toggle="collapse">Advanced Topics</a>
			  <ul id="advanced-topics-articles" class="collapse ">
			
			    <li >
			      <a href="../advanced-topics/extension-host.html" >Extension Host</a>
			    </li>
			      
			    <li >
			      <a href="../advanced-topics/remote-extensions.html" >Remote Development and Codespaces</a>
			    </li>
			      
			    <li >
			      <a href="../advanced-topics/using-proposed-api.html" >Using Proposed API</a>
			    </li>
			      
			    <li >
			      <a href="../advanced-topics/tslint-eslint-migration.html" >Migrate from TSLint to ESLint</a>
			    </li>
			      
			    <li >
			      <a href="../advanced-topics/python-extension-template.html" >Python Extension Template</a>
			    </li>
			      
			  </ul>
			</li>
			    
			<li class="panel collapsed">
			  <a class="area" role="button" href="#references-articles" data-parent="#main-nav" data-toggle="collapse">References</a>
			  <ul id="references-articles" class="collapse ">
			
			    <li >
			      <a href="../references/vscode-api.html" >VS Code API </a>
			    </li>
			      
			    <li >
			      <a href="../references/contribution-points.html" >Contribution Points</a>
			    </li>
			      
			    <li >
			      <a href="../references/activation-events.html" >Activation Events</a>
			    </li>
			      
			    <li >
			      <a href="../references/extension-manifest.html" >Extension Manifest</a>
			    </li>
			      
			    <li >
			      <a href="../references/commands.html" >Built-in Commands</a>
			    </li>
			      
			    <li >
			      <a href="../references/when-clause-contexts.html" >When clause contexts</a>
			    </li>
			      
			    <li >
			      <a href="../references/theme-color.html" >Theme Color</a>
			    </li>
			      
			    <li >
			      <a href="../references/icons-in-labels.html" >Product Icon Reference</a>
			    </li>
			      
			    <li >
			      <a href="../references/document-selector.html" >Document Selector</a>
			    </li>
			      
			  </ul>
			</li>
			    
			  </ul>
			</nav>
			
			<nav id="small-nav" aria-label="Topics" class="docs-nav hidden-md hidden-lg">
				<h4>Topics</h4>
				<select id="small-nav-dropdown" aria-label="topics">
			    <option value="/api" >Overview</option>
			
			  <optgroup label="Get Started">
			
			    <option value="/api/get-started/your-first-extension" >Your First Extension</option>
			    
			    <option value="/api/get-started/extension-anatomy" >Extension Anatomy</option>
			    
			    <option value="/api/get-started/wrapping-up" >Wrapping Up</option>
			    
			  </optgroup>
			  
			  <optgroup label="Extension Capabilities">
			
			    <option value="/api/extension-capabilities/overview" >Overview</option>
			    
			    <option value="/api/extension-capabilities/common-capabilities" >Common Capabilities</option>
			    
			    <option value="/api/extension-capabilities/theming" >Theming</option>
			    
			    <option value="/api/extension-capabilities/extending-workbench" >Extending Workbench</option>
			    
			  </optgroup>
			  
			  <optgroup label="Extension Guides">
			
			    <option value="/api/extension-guides/overview" >Overview</option>
			    
			    <option value="/api/extension-guides/command" >Command</option>
			    
			    <option value="/api/extension-guides/color-theme" >Color Theme</option>
			    
			    <option value="/api/extension-guides/file-icon-theme" >File Icon Theme</option>
			    
			    <option value="/api/extension-guides/product-icon-theme" >Product Icon Theme</option>
			    
			    <option value="/api/extension-guides/tree-view" >Tree View</option>
			    
			    <option value="/api/extension-guides/webview" >Webview</option>
			    
			    <option value="/api/extension-guides/notebook" >Notebook</option>
			    
			    <option value="/api/extension-guides/custom-editors" >Custom Editors</option>
			    
			    <option value="/api/extension-guides/virtual-documents" >Virtual Documents</option>
			    
			    <option value="/api/extension-guides/virtual-workspaces" >Virtual Workspaces</option>
			    
			    <option value="/api/extension-guides/web-extensions" >Web Extensions</option>
			    
			    <option value="/api/extension-guides/workspace-trust" >Workspace Trust</option>
			    
			    <option value="/api/extension-guides/task-provider" >Task Provider</option>
			    
			    <option value="/api/extension-guides/scm-provider" >Source Control</option>
			    
			    <option value="/api/extension-guides/debugger-extension" >Debugger Extension</option>
			    
			    <option value="/api/extension-guides/markdown-extension" >Markdown Extension</option>
			    
			    <option value="/api/extension-guides/testing" selected>Test Extension</option>
			    
			    <option value="/api/extension-guides/custom-data-extension" >Custom Data Extension</option>
			    
			    <option value="/api/extension-guides/telemetry" >Telemetry</option>
			    
			  </optgroup>
			  
			  <optgroup label="UX Guidelines">
			
			    <option value="/api/ux-guidelines/overview" >Overview</option>
			    
			    <option value="/api/ux-guidelines/activity-bar" >Activity Bar</option>
			    
			    <option value="/api/ux-guidelines/sidebars" >Sidebars</option>
			    
			    <option value="/api/ux-guidelines/panel" >Panel</option>
			    
			    <option value="/api/ux-guidelines/status-bar" >Status Bar</option>
			    
			    <option value="/api/ux-guidelines/views" >Views</option>
			    
			    <option value="/api/ux-guidelines/editor-actions" >Editor Actions</option>
			    
			    <option value="/api/ux-guidelines/quick-picks" >Quick Picks</option>
			    
			    <option value="/api/ux-guidelines/command-palette" >Command Palette</option>
			    
			    <option value="/api/ux-guidelines/notifications" >Notifications</option>
			    
			    <option value="/api/ux-guidelines/webviews" >Webviews</option>
			    
			    <option value="/api/ux-guidelines/context-menus" >Context Menus</option>
			    
			    <option value="/api/ux-guidelines/walkthroughs" >Walkthroughs</option>
			    
			    <option value="/api/ux-guidelines/settings" >Settings</option>
			    
			  </optgroup>
			  
			  <optgroup label="Language Extensions">
			
			    <option value="/api/language-extensions/overview" >Overview</option>
			    
			    <option value="/api/language-extensions/syntax-highlight-guide" >Syntax Highlight Guide</option>
			    
			    <option value="/api/language-extensions/semantic-highlight-guide" >Semantic Highlight Guide</option>
			    
			    <option value="/api/language-extensions/snippet-guide" >Snippet Guide</option>
			    
			    <option value="/api/language-extensions/language-configuration-guide" >Language Configuration Guide</option>
			    
			    <option value="/api/language-extensions/programmatic-language-features" >Programmatic Language Features</option>
			    
			    <option value="/api/language-extensions/language-server-extension-guide" >Language Server Extension Guide</option>
			    
			    <option value="/api/language-extensions/embedded-languages" >Embedded Languages</option>
			    
			  </optgroup>
			  
			  <optgroup label="Testing and Publishing">
			
			    <option value="/api/working-with-extensions/testing-extension" >Testing Extensions</option>
			    
			    <option value="/api/working-with-extensions/publishing-extension" >Publishing Extensions</option>
			    
			    <option value="/api/working-with-extensions/bundling-extension" >Bundling Extensions</option>
			    
			    <option value="/api/working-with-extensions/continuous-integration" >Continuous Integration</option>
			    
			  </optgroup>
			  
			  <optgroup label="Advanced Topics">
			
			    <option value="/api/advanced-topics/extension-host" >Extension Host</option>
			    
			    <option value="/api/advanced-topics/remote-extensions" >Remote Development and Codespaces</option>
			    
			    <option value="/api/advanced-topics/using-proposed-api" >Using Proposed API</option>
			    
			    <option value="/api/advanced-topics/tslint-eslint-migration" >Migrate from TSLint to ESLint</option>
			    
			    <option value="/api/advanced-topics/python-extension-template" >Python Extension Template</option>
			    
			  </optgroup>
			  
			  <optgroup label="References">
			
			    <option value="/api/references/vscode-api" >VS Code API </option>
			    
			    <option value="/api/references/contribution-points" >Contribution Points</option>
			    
			    <option value="/api/references/activation-events" >Activation Events</option>
			    
			    <option value="/api/references/extension-manifest" >Extension Manifest</option>
			    
			    <option value="/api/references/commands" >Built-in Commands</option>
			    
			    <option value="/api/references/when-clause-contexts" >When clause contexts</option>
			    
			    <option value="/api/references/theme-color" >Theme Color</option>
			    
			    <option value="/api/references/icons-in-labels" >Product Icon Reference</option>
			    
			    <option value="/api/references/document-selector" >Document Selector</option>
			    
			  </optgroup>
			  
				</select>
			</nav>		</div>
		<div class="col-sm-9 col-md-8 body">
			<div class="edit-github pull-right">
				<a href="https://vscode.dev/github/microsoft/vscode-docs/blob/main/api/extension-guides/testing.md"
					class="btn btn-default" title="Edit this document in vscode.dev">
					<span class="glyphicon glyphicon-pencil"></span>
					<span class="hidden-xs">Edit</span>
				</a>
			</div>
			<h1>Testing API</h1>
<p>The Testing API allows Visual Studio Code extensions to discover tests in the workspace and publish results. Users can execute tests in the Test Explorer view, from decorations, and inside commands. With these new APIs, Visual Studio Code supports richer displays of outputs and diffs than was previously possible.</p>
<blockquote>
<p><strong>Note</strong>: The Testing API is available in VS Code version 1.59 and higher.</p>
</blockquote>
<h2 id="examples" data-needslink="examples">Examples</h2>
<p>There are two test providers maintained by the VS Code team:</p>
<ul>
<li>The <a href="https://github.com/microsoft/vscode-extension-samples/tree/main/test-provider-sample" class="external-link" target="_blank">sample test extension</a>, which provides tests in Markdown files.</li>
<li>The <a href="https://github.com/microsoft/vscode-selfhost-test-provider" class="external-link" target="_blank">selfhost test extension</a>, that we use for running tests in VS Code itself.</li>
</ul>
<h2 id="discovering-tests" data-needslink="discovering-tests">Discovering tests</h2>
<p>Tests are provided by the <code>TestController</code>, which requires a globally unique ID and human-readable label to create:</p>
<pre class="shiki" style="background-color: #FFFFFF"><code><span class="line"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">controller</span><span style="color: #000000"> = </span><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #001080">tests</span><span style="color: #000000">.</span><span style="color: #795E26">createTestController</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #A31515">&#39;helloWorldTests&#39;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #A31515">&#39;Hello World Tests&#39;</span></span>
<span class="line"><span style="color: #000000">);</span></span>
<span class="line"></span></code></pre>
<p>To publish tests, you add <code>TestItem</code>s as children to the controller's <code>items</code> collection. <code>TestItem</code>s are the foundation of the test API in the <code>TestItem</code> interface, and are a generic type that can describe a test case, suite, or tree item as it exists in code. They can, in turn, have <code>children</code> themselves, forming a hierarchy. For example, here's a simplified version of how the sample test extension creates tests:</p>
<pre class="shiki" style="background-color: #FFFFFF"><code><span class="line"><span style="color: #795E26">parseMarkdown</span><span style="color: #000000">(</span><span style="color: #001080">content</span><span style="color: #000000">, {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #795E26">onTest</span><span style="color: #001080">:</span><span style="color: #000000"> (</span><span style="color: #001080">range</span><span style="color: #000000">, </span><span style="color: #001080">numberA</span><span style="color: #000000">, </span><span style="color: #001080">mathOperator</span><span style="color: #000000">, </span><span style="color: #001080">numberB</span><span style="color: #000000">, </span><span style="color: #001080">expectedValue</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// If this is a top-level test, add it to its parent&#39;s children. If not,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// add it to the controller&#39;s top level items.</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">collection</span><span style="color: #000000"> = </span><span style="color: #001080">parent</span><span style="color: #000000"> ? </span><span style="color: #001080">parent</span><span style="color: #000000">.</span><span style="color: #001080">children</span><span style="color: #000000"> : </span><span style="color: #001080">controller</span><span style="color: #000000">.</span><span style="color: #001080">items</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// Create a new ID that&#39;s unique among the parent&#39;s children:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">id</span><span style="color: #000000"> = [</span><span style="color: #001080">numberA</span><span style="color: #000000">, </span><span style="color: #001080">mathOperator</span><span style="color: #000000">, </span><span style="color: #001080">numberB</span><span style="color: #000000">, </span><span style="color: #001080">expectedValue</span><span style="color: #000000">].</span><span style="color: #795E26">join</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;  &#39;</span><span style="color: #000000">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// Finally, create the test item:</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">test</span><span style="color: #000000"> = </span><span style="color: #001080">controller</span><span style="color: #000000">.</span><span style="color: #795E26">createTestItem</span><span style="color: #000000">(</span><span style="color: #001080">id</span><span style="color: #000000">, </span><span style="color: #001080">data</span><span style="color: #000000">.</span><span style="color: #795E26">getLabel</span><span style="color: #000000">(), </span><span style="color: #001080">item</span><span style="color: #000000">.</span><span style="color: #001080">uri</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">test</span><span style="color: #000000">.</span><span style="color: #001080">range</span><span style="color: #000000"> = </span><span style="color: #001080">range</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">collection</span><span style="color: #000000">.</span><span style="color: #795E26">add</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// ...</span></span>
<span class="line"><span style="color: #000000">});</span></span>
<span class="line"></span></code></pre>
<p>Similar to Diagnostics, it's mostly up to the extension to control when tests are discovered. A simple extension might watch the entire workspace and parse all tests in all files at activation. However, parsing everything immediately may be slow for large workspaces. Instead, you can do two things:</p>
<ol>
<li>Actively discover tests for a file when it's opened in the editor, by watching <code>vscode.workspace.onDidOpenTextDocument</code>.</li>
<li>Setting <code>item.canResolveChildren = true</code> and setting the <code>controller.resolveHandler</code>. The <code>resolveHandler</code> is called if the user takes an action to demand tests be discovered, such as by expanding an item in the Test Explorer.</li>
</ol>
<p>Here's how this strategy might look in an extension that parses files lazily:</p>
<pre class="shiki" style="background-color: #FFFFFF"><code><span class="line"><span style="color: #008000">// First, create the `resolveHandler`. This may initially be called with</span></span>
<span class="line"><span style="color: #008000">// &quot;undefined&quot; to ask for all tests in the workspace to be discovered, usually</span></span>
<span class="line"><span style="color: #008000">// when the user opens the Test Explorer for the first time.</span></span>
<span class="line"><span style="color: #001080">controller</span><span style="color: #000000">.</span><span style="color: #795E26">resolveHandler</span><span style="color: #000000"> = </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #001080">test</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (!</span><span style="color: #001080">test</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">discoverAllFilesInWorkspace</span><span style="color: #000000">();</span></span>
<span class="line"><span style="color: #000000">  } </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">parseTestsInFileContents</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">// When text documents are open, parse tests in them.</span></span>
<span class="line"><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #001080">workspace</span><span style="color: #000000">.</span><span style="color: #795E26">onDidOpenTextDocument</span><span style="color: #000000">(</span><span style="color: #001080">parseTestsInDocument</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #008000">// We could also listen to document changes to re-parse unsaved changes:</span></span>
<span class="line"><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #001080">workspace</span><span style="color: #000000">.</span><span style="color: #795E26">onDidChangeTextDocument</span><span style="color: #000000">(</span><span style="color: #001080">e</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #795E26">parseTestsInDocument</span><span style="color: #000000">(</span><span style="color: #001080">e</span><span style="color: #000000">.</span><span style="color: #001080">document</span><span style="color: #000000">));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">// In this function, we&#39;ll get the file TestItem if we&#39;ve already found it,</span></span>
<span class="line"><span style="color: #008000">// otherwise we&#39;ll create it with `canResolveChildren = true` to indicate it</span></span>
<span class="line"><span style="color: #008000">// can be passed to the `controller.resolveHandler` to gets its children.</span></span>
<span class="line"><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">getOrCreateFile</span><span style="color: #000000">(</span><span style="color: #001080">uri</span><span style="color: #000000">: </span><span style="color: #267F99">vscode</span><span style="color: #000000">.</span><span style="color: #267F99">Uri</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">existing</span><span style="color: #000000"> = </span><span style="color: #001080">controller</span><span style="color: #000000">.</span><span style="color: #001080">items</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #001080">uri</span><span style="color: #000000">.</span><span style="color: #795E26">toString</span><span style="color: #000000">());</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">existing</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">existing</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">file</span><span style="color: #000000"> = </span><span style="color: #001080">controller</span><span style="color: #000000">.</span><span style="color: #795E26">createTestItem</span><span style="color: #000000">(</span><span style="color: #001080">uri</span><span style="color: #000000">.</span><span style="color: #795E26">toString</span><span style="color: #000000">(), </span><span style="color: #001080">uri</span><span style="color: #000000">.</span><span style="color: #001080">path</span><span style="color: #000000">.</span><span style="color: #795E26">split</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;/&#39;</span><span style="color: #000000">).</span><span style="color: #795E26">pop</span><span style="color: #000000">()!, </span><span style="color: #001080">uri</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">file</span><span style="color: #000000">.</span><span style="color: #001080">canResolveChildren</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">file</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">parseTestsInDocument</span><span style="color: #000000">(</span><span style="color: #001080">e</span><span style="color: #000000">: </span><span style="color: #267F99">vscode</span><span style="color: #000000">.</span><span style="color: #267F99">TextDocument</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">e</span><span style="color: #000000">.</span><span style="color: #001080">uri</span><span style="color: #000000">.</span><span style="color: #001080">scheme</span><span style="color: #000000"> === </span><span style="color: #A31515">&#39;file&#39;</span><span style="color: #000000"> &amp;&amp; </span><span style="color: #001080">e</span><span style="color: #000000">.</span><span style="color: #001080">uri</span><span style="color: #000000">.</span><span style="color: #001080">path</span><span style="color: #000000">.</span><span style="color: #795E26">endsWith</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;.md&#39;</span><span style="color: #000000">)) {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #795E26">parseTestsInFileContents</span><span style="color: #000000">(</span><span style="color: #795E26">getOrCreateFile</span><span style="color: #000000">(</span><span style="color: #001080">e</span><span style="color: #000000">.</span><span style="color: #001080">uri</span><span style="color: #000000">), </span><span style="color: #001080">e</span><span style="color: #000000">.</span><span style="color: #795E26">getText</span><span style="color: #000000">());</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">parseTestsInFileContents</span><span style="color: #000000">(</span><span style="color: #001080">file</span><span style="color: #000000">: </span><span style="color: #267F99">vscode</span><span style="color: #000000">.</span><span style="color: #267F99">TestItem</span><span style="color: #000000">, </span><span style="color: #001080">contents</span><span style="color: #000000">?: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// If a document is open, VS Code already knows its contents. If this is being</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// called from the resolveHandler when a document isn&#39;t open, we&#39;ll need to</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// read them from disk ourselves.</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">contents</span><span style="color: #000000"> === </span><span style="color: #0000FF">undefined</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">rawContent</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #001080">workspace</span><span style="color: #000000">.</span><span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">readFile</span><span style="color: #000000">(</span><span style="color: #001080">file</span><span style="color: #000000">.</span><span style="color: #001080">uri</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">contents</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">TextDecoder</span><span style="color: #000000">().</span><span style="color: #795E26">decode</span><span style="color: #000000">(</span><span style="color: #001080">rawContent</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// some custom logic to fill in test.children from the contents...</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span></code></pre>
<p>The implementation of <code>discoverAllFilesInWorkspace</code> can be built using VS Code' existing file watching functionality. When the <code>resolveHandler</code> is called, you should continue watching for changes so that the data in the Test Explorer stays up to date.</p>
<pre class="shiki" style="background-color: #FFFFFF"><code><span class="line"><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">discoverAllFilesInWorkspace</span><span style="color: #000000">() {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (!</span><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #001080">workspace</span><span style="color: #000000">.</span><span style="color: #001080">workspaceFolders</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> []; </span><span style="color: #008000">// handle the case of no open folders</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #267F99">Promise</span><span style="color: #000000">.</span><span style="color: #795E26">all</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #001080">workspace</span><span style="color: #000000">.</span><span style="color: #001080">workspaceFolders</span><span style="color: #000000">.</span><span style="color: #795E26">map</span><span style="color: #000000">(</span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #001080">workspaceFolder</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">pattern</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #795E26">RelativePattern</span><span style="color: #000000">(</span><span style="color: #001080">workspaceFolder</span><span style="color: #000000">, </span><span style="color: #A31515">&#39;**/*.md&#39;</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">watcher</span><span style="color: #000000"> = </span><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #001080">workspace</span><span style="color: #000000">.</span><span style="color: #795E26">createFileSystemWatcher</span><span style="color: #000000">(</span><span style="color: #001080">pattern</span><span style="color: #000000">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// When files are created, make sure there&#39;s a corresponding &quot;file&quot; node in the tree</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #001080">watcher</span><span style="color: #000000">.</span><span style="color: #795E26">onDidCreate</span><span style="color: #000000">(</span><span style="color: #001080">uri</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #795E26">getOrCreateFile</span><span style="color: #000000">(</span><span style="color: #001080">uri</span><span style="color: #000000">));</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// When files change, re-parse them. Note that you could optimize this so</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// that you only re-parse children that have been resolved in the past.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #001080">watcher</span><span style="color: #000000">.</span><span style="color: #795E26">onDidChange</span><span style="color: #000000">(</span><span style="color: #001080">uri</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #795E26">parseTestsInFileContents</span><span style="color: #000000">(</span><span style="color: #795E26">getOrCreateFile</span><span style="color: #000000">(</span><span style="color: #001080">uri</span><span style="color: #000000">)));</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// And, finally, delete TestItems for removed files. This is simple, since</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// we use the URI as the TestItem&#39;s ID.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #001080">watcher</span><span style="color: #000000">.</span><span style="color: #795E26">onDidDelete</span><span style="color: #000000">(</span><span style="color: #001080">uri</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">controller</span><span style="color: #000000">.</span><span style="color: #001080">items</span><span style="color: #000000">.</span><span style="color: #795E26">delete</span><span style="color: #000000">(</span><span style="color: #001080">uri</span><span style="color: #000000">.</span><span style="color: #795E26">toString</span><span style="color: #000000">()));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">for</span><span style="color: #000000"> (</span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">file</span><span style="color: #000000"> </span><span style="color: #0000FF">of</span><span style="color: #000000"> </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #001080">workspace</span><span style="color: #000000">.</span><span style="color: #795E26">findFiles</span><span style="color: #000000">(</span><span style="color: #001080">pattern</span><span style="color: #000000">)) {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #795E26">getOrCreateFile</span><span style="color: #000000">(</span><span style="color: #001080">file</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">watcher</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">    })</span></span>
<span class="line"><span style="color: #000000">  );</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span></code></pre>
<p>The <code>TestItem</code> interface is simple and doesn't have room for custom data. If you need to associate extra information with a <code>TestItem</code>, you can use a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap" class="external-link" target="_blank"><code>WeakMap</code></a>:</p>
<pre class="shiki" style="background-color: #FFFFFF"><code><span class="line"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">testData</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">WeakMap</span><span style="color: #000000">&lt;</span><span style="color: #267F99">vscode</span><span style="color: #000000">.</span><span style="color: #267F99">TestItem</span><span style="color: #000000">, </span><span style="color: #267F99">MyCustomData</span><span style="color: #000000">&gt;();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">// to associate data:</span></span>
<span class="line"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">item</span><span style="color: #000000"> = </span><span style="color: #001080">controller</span><span style="color: #000000">.</span><span style="color: #795E26">createTestItem</span><span style="color: #000000">(</span><span style="color: #001080">id</span><span style="color: #000000">, </span><span style="color: #001080">label</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #001080">testData</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #001080">item</span><span style="color: #000000">, </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">MyCustomData</span><span style="color: #000000">());</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">// to get it back later:</span></span>
<span class="line"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">myData</span><span style="color: #000000"> = </span><span style="color: #001080">testData</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #001080">item</span><span style="color: #000000">);</span></span>
<span class="line"></span></code></pre>
<p>It's guaranteed that the <code>TestItem</code> instances passed to all <code>TestController</code>-related methods will be the same as the ones originally created from <code>createTestItem</code>, so you can be sure that getting the item from the <code>testData</code> map will work.</p>
<p>For this example, let's just store the type of each item:</p>
<pre class="shiki" style="background-color: #FFFFFF"><code><span class="line"><span style="color: #0000FF">enum</span><span style="color: #000000"> </span><span style="color: #267F99">ItemType</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0070C1">File</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0070C1">TestCase</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">testData</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">WeakMap</span><span style="color: #000000">&lt;</span><span style="color: #267F99">vscode</span><span style="color: #000000">.</span><span style="color: #267F99">TestItem</span><span style="color: #000000">, </span><span style="color: #267F99">ItemType</span><span style="color: #000000">&gt;();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #795E26">getType</span><span style="color: #000000"> = (</span><span style="color: #001080">testItem</span><span style="color: #000000">: </span><span style="color: #267F99">vscode</span><span style="color: #000000">.</span><span style="color: #267F99">TestItem</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">testData</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #001080">ItemType</span><span style="color: #000000">)!;</span></span>
<span class="line"></span></code></pre>
<h2 id="running-tests" data-needslink="running-tests">Running tests</h2>
<p>Tests are executed through <code>TestRunProfile</code>s. Each profile belongs to a specific execution <code>kind</code>: run, debug, or coverage. Most test extensions will have at most one profile in each of these groups, but more are allowed. For example, if your extension runs tests on multiple platforms, you could have one profile for each combination of platform and <code>kind</code>. Each profile has a <code>runHandler</code>, which is invoked when a run of that type is requested.</p>
<pre class="shiki" style="background-color: #FFFFFF"><code><span class="line"><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">runHandler</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">shouldDebug</span><span style="color: #000000">: </span><span style="color: #267F99">boolean</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">request</span><span style="color: #000000">: </span><span style="color: #267F99">vscode</span><span style="color: #000000">.</span><span style="color: #267F99">TestRunRequest</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">token</span><span style="color: #000000">: </span><span style="color: #267F99">vscode</span><span style="color: #000000">.</span><span style="color: #267F99">CancellationToken</span></span>
<span class="line"><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// todo</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">runProfile</span><span style="color: #000000"> = </span><span style="color: #001080">controller</span><span style="color: #000000">.</span><span style="color: #795E26">createRunProfile</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #A31515">&#39;Run&#39;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #001080">TestRunProfileKind</span><span style="color: #000000">.</span><span style="color: #001080">Run</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  (</span><span style="color: #001080">request</span><span style="color: #000000">, </span><span style="color: #001080">token</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #795E26">runHandler</span><span style="color: #000000">(</span><span style="color: #0000FF">false</span><span style="color: #000000">, </span><span style="color: #001080">request</span><span style="color: #000000">, </span><span style="color: #001080">token</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">debugProfile</span><span style="color: #000000"> = </span><span style="color: #001080">controller</span><span style="color: #000000">.</span><span style="color: #795E26">createRunProfile</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #A31515">&#39;Debug&#39;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #001080">TestRunProfileKind</span><span style="color: #000000">.</span><span style="color: #001080">Debug</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  (</span><span style="color: #001080">request</span><span style="color: #000000">, </span><span style="color: #001080">token</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #795E26">runHandler</span><span style="color: #000000">(</span><span style="color: #0000FF">true</span><span style="color: #000000">, </span><span style="color: #001080">request</span><span style="color: #000000">, </span><span style="color: #001080">token</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">);</span></span>
<span class="line"></span></code></pre>
<p>The <code>runHandler</code> should call <code>controller.createTestRun</code> at least once, passing through the original request. The request contains the tests to <code>include</code> in the test run (which is omitted if the user asked to run all tests) and possibly tests to <code>exclude</code> from the run. The extension should use the resulting <code>TestRun</code> object to update the state of tests involved in the run. For example:</p>
<pre class="shiki" style="background-color: #FFFFFF"><code><span class="line"><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">runHandler</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">shouldDebug</span><span style="color: #000000">: </span><span style="color: #267F99">boolean</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">request</span><span style="color: #000000">: </span><span style="color: #267F99">vscode</span><span style="color: #000000">.</span><span style="color: #267F99">TestRunRequest</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">token</span><span style="color: #000000">: </span><span style="color: #267F99">vscode</span><span style="color: #000000">.</span><span style="color: #267F99">CancellationToken</span></span>
<span class="line"><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">run</span><span style="color: #000000"> = </span><span style="color: #001080">controller</span><span style="color: #000000">.</span><span style="color: #795E26">createTestRun</span><span style="color: #000000">(</span><span style="color: #001080">request</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">queue</span><span style="color: #000000">: </span><span style="color: #267F99">vscode</span><span style="color: #000000">.</span><span style="color: #267F99">TestItem</span><span style="color: #000000">[] = [];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// Loop through all included tests, or all known tests, and add them to our queue</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">request</span><span style="color: #000000">.</span><span style="color: #001080">include</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">request</span><span style="color: #000000">.</span><span style="color: #001080">include</span><span style="color: #000000">.</span><span style="color: #795E26">forEach</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">queue</span><span style="color: #000000">.</span><span style="color: #795E26">push</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000">));</span></span>
<span class="line"><span style="color: #000000">  } </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">controller</span><span style="color: #000000">.</span><span style="color: #001080">items</span><span style="color: #000000">.</span><span style="color: #795E26">forEach</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">queue</span><span style="color: #000000">.</span><span style="color: #795E26">push</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000">));</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// For every test that was queued, try to run it. Call run.passed() or run.failed().</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// The `TestMessage` can contain extra information, like a failing location or</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// a diff output. But here we&#39;ll just give it a textual message.</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">while</span><span style="color: #000000"> (</span><span style="color: #001080">queue</span><span style="color: #000000">.</span><span style="color: #001080">length</span><span style="color: #000000"> &gt; </span><span style="color: #098658">0</span><span style="color: #000000"> &amp;&amp; !</span><span style="color: #001080">token</span><span style="color: #000000">.</span><span style="color: #001080">isCancellationRequested</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">test</span><span style="color: #000000"> = </span><span style="color: #001080">queue</span><span style="color: #000000">.</span><span style="color: #795E26">pop</span><span style="color: #000000">()!;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// Skip tests the user asked to exclude</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">request</span><span style="color: #000000">.</span><span style="color: #001080">exclude</span><span style="color: #000000">?.</span><span style="color: #795E26">includes</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000">)) {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">continue</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">switch</span><span style="color: #000000"> (</span><span style="color: #795E26">getType</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000">)) {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">case</span><span style="color: #000000"> </span><span style="color: #001080">ItemType</span><span style="color: #000000">.</span><span style="color: #001080">File</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// If we&#39;re running a file and don&#39;t know what it contains yet, parse it now</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">test</span><span style="color: #000000">.</span><span style="color: #001080">children</span><span style="color: #000000">.</span><span style="color: #001080">size</span><span style="color: #000000"> === </span><span style="color: #098658">0</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">parseTestsInFileContents</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #AF00DB">break</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #AF00DB">case</span><span style="color: #000000"> </span><span style="color: #001080">ItemType</span><span style="color: #000000">.</span><span style="color: #001080">TestCase</span><span style="color: #000000">:</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// Otherwise, just run the test case. Note that we don&#39;t need to manually</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// set the state of parent tests; they&#39;ll be set automatically.</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">start</span><span style="color: #000000"> = </span><span style="color: #001080">Date</span><span style="color: #000000">.</span><span style="color: #795E26">now</span><span style="color: #000000">();</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #AF00DB">try</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">assertTestPasses</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #001080">run</span><span style="color: #000000">.</span><span style="color: #795E26">passed</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000">, </span><span style="color: #001080">Date</span><span style="color: #000000">.</span><span style="color: #795E26">now</span><span style="color: #000000">() - </span><span style="color: #001080">start</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">        } </span><span style="color: #AF00DB">catch</span><span style="color: #000000"> (</span><span style="color: #001080">e</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">          </span><span style="color: #001080">run</span><span style="color: #000000">.</span><span style="color: #795E26">failed</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000">, </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #795E26">TestMessage</span><span style="color: #000000">(</span><span style="color: #001080">e</span><span style="color: #000000">.</span><span style="color: #001080">message</span><span style="color: #000000">), </span><span style="color: #001080">Date</span><span style="color: #000000">.</span><span style="color: #795E26">now</span><span style="color: #000000">() - </span><span style="color: #001080">start</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #AF00DB">break</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">test</span><span style="color: #000000">.</span><span style="color: #001080">children</span><span style="color: #000000">.</span><span style="color: #795E26">forEach</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">queue</span><span style="color: #000000">.</span><span style="color: #795E26">push</span><span style="color: #000000">(</span><span style="color: #001080">test</span><span style="color: #000000">));</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// Make sure to end the run after all tests have been executed:</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">run</span><span style="color: #000000">.</span><span style="color: #795E26">end</span><span style="color: #000000">();</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span></code></pre>
<p>In addition to the <code>runHandler</code>, you can set a <code>configureHandler</code> on the <code>TestRunProfile</code>. If present, VS Code will have UI to allow the user to configure the test run, and call the handler when they do so. From here, you can open files, show a Quick Pick, or do whatever is appropriate for your test framework.</p>
<blockquote>
<p>VS Code intentionally handles test configuration differently than debug or task configuration. These are traditionally editor or IDE-centric features, and are configured in special files in the <code>.vscode</code> folder. However, tests have traditionally been executed from the command line, and most test frameworks have existing configuration strategies. Therefore, in VS Code, we avoid duplication of configuration and instead leave it up to extensions to handle.</p>
</blockquote>
<h3 id="test-output" data-needslink="test-output">Test Output</h3>
<p>In addition to the messages passed to <code>TestRun.failed</code> or <code>TestRun.errored</code>, you can append generic output using <code>run.appendOutput(str)</code>. This output can be displayed in a terminal using the <strong>Test: Show Output</strong> and through various buttons in the UI, such as the terminal icon in the Test Explorer view.</p>
<p>Because the string is rendered in a terminal, you can use the full set of <a href="https://en.wikipedia.org/wiki/ANSI_escape_code" class="external-link" target="_blank">ANSI codes</a>, including the styles available in the <a href="https://www.npmjs.com/package/ansi-styles" class="external-link" target="_blank">ansi-styles</a> npm package. Bear in mind that, because it is in a terminal, lines must be wrapped using CRLF (<code>\r\n</code>), not just LF (<code>\n</code>), which may be the default output from some tools.</p>
<h3 id="test-tags" data-needslink="test-tags">Test Tags</h3>
<p>Sometime tests can only be run under certain configurations, or not at all. For these use cases, you can use Test Tags. <code>TestRunProfile</code>s can optionally have a tag associated with them and, if they do, only tests that have that tag can be run under the profile. Once again, if there is no eligible profile to run, debug, or gather coverage from a specific test, those options will not be shown in the UI.</p>
<pre class="shiki" style="background-color: #FFFFFF"><code><span class="line"><span style="color: #008000">// Create a new tag with an ID of &quot;runnable&quot;</span></span>
<span class="line"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">runnableTag</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">TestTag</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;runnable&#39;</span><span style="color: #000000">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">// Assign it to a profile. Now this profile can only execute tests with that tag.</span></span>
<span class="line"><span style="color: #001080">runProfile</span><span style="color: #000000">.</span><span style="color: #001080">tag</span><span style="color: #000000"> = </span><span style="color: #001080">runnableTag</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">// Add the &quot;runnable&quot; tag to all applicable tests.</span></span>
<span class="line"><span style="color: #AF00DB">for</span><span style="color: #000000"> (</span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">test</span><span style="color: #000000"> </span><span style="color: #0000FF">of</span><span style="color: #000000"> </span><span style="color: #795E26">getAllRunnableTests</span><span style="color: #000000">()) {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">test</span><span style="color: #000000">.</span><span style="color: #001080">tags</span><span style="color: #000000"> = [...</span><span style="color: #001080">test</span><span style="color: #000000">.</span><span style="color: #001080">tags</span><span style="color: #000000">, </span><span style="color: #001080">runnableTag</span><span style="color: #000000">];</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span></code></pre>
<p>Users can also filter by tags in the Test Explorer UI.</p>
<h3 id="publishonly-controllers" data-needslink="publishonly-controllers">Publish-only controllers</h3>
<p>The presence of run profiles is optional. A controller is allowed to create tests, call <code>createTestRun</code> outside of the <code>runHandler</code>, and update tests' states in the run without having a profile. The common use case for this are controllers who load their results from an external source, like CI or summary files.</p>
<p>In this case, these controllers should usually pass the optional <code>name</code> argument to <code>createTestRun</code>, and <code>false</code> for the <code>persist</code> argument. Passing <code>false</code> here instructs VS Code not to retain the test result, like it would for runs in the editor, since these results can be reloaded from an external source externally.</p>
<pre class="shiki" style="background-color: #FFFFFF"><code><span class="line"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">controller</span><span style="color: #000000"> = </span><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #001080">tests</span><span style="color: #000000">.</span><span style="color: #795E26">createTestController</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #A31515">&#39;myCoverageFileTests&#39;</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #A31515">&#39;Coverage File Tests&#39;</span></span>
<span class="line"><span style="color: #000000">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #001080">commands</span><span style="color: #000000">.</span><span style="color: #795E26">registerCommand</span><span style="color: #000000">(</span><span style="color: #A31515">&#39;myExtension.loadTestResultFile&#39;</span><span style="color: #000000">, </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #001080">file</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">info</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">readFile</span><span style="color: #000000">(</span><span style="color: #001080">file</span><span style="color: #000000">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// set the controller items to those read from the file:</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">controller</span><span style="color: #000000">.</span><span style="color: #001080">items</span><span style="color: #000000">.</span><span style="color: #795E26">replace</span><span style="color: #000000">(</span><span style="color: #795E26">readTestsFromInfo</span><span style="color: #000000">(</span><span style="color: #001080">info</span><span style="color: #000000">));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// create your own custom test run, then you can immediately set the state of</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// items in the run and end it to publish results:</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">run</span><span style="color: #000000"> = </span><span style="color: #001080">controller</span><span style="color: #000000">.</span><span style="color: #795E26">createTestRun</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #795E26">TestRunRequest</span><span style="color: #000000">(),</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">path</span><span style="color: #000000">.</span><span style="color: #795E26">basename</span><span style="color: #000000">(</span><span style="color: #001080">file</span><span style="color: #000000">),</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">false</span></span>
<span class="line"><span style="color: #000000">  );</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #AF00DB">for</span><span style="color: #000000"> (</span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">result</span><span style="color: #000000"> </span><span style="color: #0000FF">of</span><span style="color: #000000"> </span><span style="color: #001080">info</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">result</span><span style="color: #000000">.</span><span style="color: #001080">passed</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #001080">run</span><span style="color: #000000">.</span><span style="color: #795E26">passed</span><span style="color: #000000">(</span><span style="color: #001080">result</span><span style="color: #000000">.</span><span style="color: #001080">item</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">    } </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #001080">run</span><span style="color: #000000">.</span><span style="color: #795E26">failed</span><span style="color: #000000">(</span><span style="color: #001080">result</span><span style="color: #000000">.</span><span style="color: #001080">item</span><span style="color: #000000">, </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #001080">vscode</span><span style="color: #000000">.</span><span style="color: #795E26">TestMessage</span><span style="color: #000000">(</span><span style="color: #001080">result</span><span style="color: #000000">.</span><span style="color: #001080">message</span><span style="color: #000000">));</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">run</span><span style="color: #000000">.</span><span style="color: #795E26">end</span><span style="color: #000000">();</span></span>
<span class="line"><span style="color: #000000">});</span></span>
<span class="line"></span></code></pre>
<h2 id="migrating-from-the-test-explorer-ui" data-needslink="migrating-from-the-test-explorer-ui">Migrating from the Test Explorer UI</h2>
<p>If you have an existing extension using the Test Explorer UI, we suggest you migrate to the native experience for additional features and efficiency. We've put together a repo with an example migration of the Test Adapter sample in its <a href="https://github.com/connor4312/test-controller-migration-example/commits/master" class="external-link" target="_blank">Git history</a>. You can view each step by selecting the commit name, starting from  <code>[1] Create a native TestController</code>.</p>
<p>In summary, the general steps are:</p>
<ol>
<li>
<p>Instead of retrieving and registering a <code>TestAdapter</code> with the Test Explorer UI's <code>TestHub</code>, call <code>const controller = vscode.tests.createTestController(...)</code>.</p>
</li>
<li>
<p>Rather than firing <code>testAdapter.tests</code> when you discover or rediscover tests, instead create and push tests into <code>controller.items</code>, for example by calling <code>controller.items.replace</code> with an array of discovered tests that are created by calling <code>vscode.test.createTestItem</code>. Note that, as tests change, you can mutate properties on the test item and update their children, and changes will be reflected automatically in VS Code's UI.</p>
</li>
<li>
<p>To load tests initially, instead of waiting for a <code>testAdapter.load()</code> method call, set <code>controller.resolveHandler = () =&gt; { /* discover tests */ }</code>. See more information around how test discovery works in <a href="#discovering-tests">Discovering Tests</a>.</p>
</li>
<li>
<p>To run tests, you should create a <a href="#running-tests">Run Profile</a> with a handler function that calls <code>const run = controller.createTestRun(request)</code>. Instead of firing a <code>testStates</code> event, pass <code>TestItem</code>s to methods on the <code>run</code> to update their state.</p>
</li>
</ol>
<h2 id="additional-contribution-points" data-needslink="additional-contribution-points">Additional contribution points</h2>
<p>The <code>testing/item/context</code> <a href="../references/contribution-points.html#contributes.menus">menu contribution point</a> may be used to add menu items to Tests in the Test Explorer view. Place menu items in the <code>inline</code> group to have them inline. All other menu item groups will be displayed in a context menu accessible using the mouse right-click.</p>
<p>Additional <a href="../references/when-clause-contexts.html">context keys</a> are available in the <code>when</code> clauses of your menu items: <code>testId</code>, <code>controllerId</code>, and <code>testItemHasUri</code>. For more complex <code>when</code> scenarios, where you want actions to be optionally available for different Test Items, consider using the <a href="../references/when-clause-contexts.html#in-conditional-operator"><code>in</code> conditional operator</a>.</p>
<p>If you want to reveal a test in the Explorer, you can pass the test to the command <code>vscode.commands.executeCommand('vscode.revealTestInExplorer', testItem)</code>.</p>

			<div class="feedback"></div>
			
			<div class="body-footer">12/7/2022</div>
			
		</div>
		<div class="col-sm-3 col-md-2 docs-subnavbar-container">
			<nav id="docs-subnavbar" aria-label="On Page" data-spy="affix" data-offset-top="20">
				
				<h4><span class="sr-only">In this article there are 5 sections</span><span
						aria-hidden="true">In this article</span></h4>
				<ul class="nav">
					
					<li><a href="#examples">Examples</a></li>
					
					<li><a href="#discovering-tests">Discovering tests</a></li>
					
					<li><a href="#running-tests">Running tests</a></li>
					
					<li><a href="#migrating-from-the-test-explorer-ui">Migrating from the Test Explorer UI</a></li>
					
					<li><a href="#additional-contribution-points">Additional contribution points</a></li>
					
				</ul>
				
				<div class="connect-widget"></div>
			</nav>
		</div>
	</div>
</div>
      </div>
  </div>

  <footer role="contentinfo">
      <div class="container">
          <div class="row">
              <div class="left col-md-7">
                  <ul class="links">
                      <li>
                          <span class="message">Hello from Seattle.</span>
                      </li>
                      <li>
                          <a href="https://go.microsoft.com/fwlink/?LinkID=533687" onclick="followOnTwitter()" tabindex="0">Follow @code</a>
                      </li>
                      <li>
                          <div class="github-star-button">
                              <iframe src="../../assets/github-button29be.html?user=Microsoft&amp;repo=vscode&amp;type=star&amp;count=true"
                                  frameborder="0" scrolling="0" width="130px" height="20px" title="GitHub follow button" loading="lazy"></iframe>
                          </div>
                      </li>
  
                      <script>
                          function followOnTwitter() {
                              var windowFeatures = "location=yes,height=600,width=550,scrollbars=yes,status=yes";
                              var originalReferer = "&original_referer=" + document.URL;
                              var screenName = "&screen_name=code";
                              var URL = "https://twitter.com/intent/follow?" + originalReferer + screenName;
                              window.open(URL, "_blank", windowFeatures);
                          }
  
                          function manageConsent() {
                              if(WcpConsent.siteConsent.isConsentRequired){
                                  WcpConsent.siteConsent.manageConsent();
                              }
                          }
                      </script>
                  </ul>
              </div>
              <div class="right col-md-5">
                  <ul class="links">
                      <li><a id="footer-support-link" href="https://support.serviceshub.microsoft.com/supportforbusiness/create?sapId=d66407ed-3967-b000-4cfb-2c318cad363d"
                              target="_blank">Support</a></li>
                      <li><a id="footer-privacy-link" href="https://privacy.microsoft.com/privacystatement"
                              target="_blank">Privacy</a></li>
                      <li style="display: none;"><a id="footer-cookie-link" style="cursor: pointer;" onclick="manageConsent()"
                              target="_blank">Manage Cookies</a></li>
                      <li><a id="footer-terms-link" href="https://www.microsoft.com/legal/terms-of-use"
                              target="_blank">Terms of Use</a></li>
                      <li><a id="footer-license-link" href="../../License.html">License</a></li>
                  </ul>
                  <div class="copyright">
                      <a id="footer-microsoft-link" class="logo" href="https://www.microsoft.com/">
                          <img class="microsoft-logo" src="../../assets/images/microsoft-logo.png" height="20" alt="Microsoft homepage"/>
                          <img class="microsoft-logo-inverted" src="../../assets/images/microsoft-logo-inverted.png" height="20" alt="Microsoft homepage" />
                      </a>
                      <span>&copy; 2023 Microsoft</span>
                  </div>
              </div>
          </div>
      </div>
  </footer>
  <script src="../../dist/index.js"></script>

  

  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "SoftwareApplication",
      "name" : "Visual Studio Code",
      "softwareVersion": "1.74",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "applicationCategory": "DeveloperApplication",
      "applicationSubCategory": "Text Editor",
      "alternateName": "VS Code",
      "datePublished": "2021-11-03",
      "operatingSystem": "Mac, Linux, Windows",
      "logo": "https://code.visualstudio.com/assets/apple-touch-icon.png",
      "screenshot": "https://code.visualstudio.com/assets/home/home-screenshot-win.png",
      "releaseNotes": "https://code.visualstudio.com/updates",
      "downloadUrl": "https://code.visualstudio.com/download",
      "license": "https://code.visualstudio.com/license",
      "softwareRequirements": "https://code.visualstudio.com/docs/supporting/requirements",
      "url" : "https://code.visualstudio.com",
      "author": {
        "@type": "Organization",
        "name": "Microsoft"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Microsoft"
      },
      "maintainer": {
        "@type": "Organization",
        "name": "Microsoft"
      },
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://code.visualstudio.com/Search?q={search_term_string}",
        "query-input": "required name=search_term_string"
      },
      "sameAs" : [
        "https://en.wikipedia.org/wiki/Visual_Studio_Code",
        "https://twitter.com/code",
        "https://www.youtube.com/code",
        "https://www.tiktok.com/@vscode",
        "https://github.com/microsoft/vscode"
      ]
    }
  </script>
</body>

<!-- Mirrored from code.visualstudio.com/api/extension-guides/testing by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 04 Jan 2023 11:25:52 GMT -->
</html>